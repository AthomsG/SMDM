<<<<<<< Updated upstream
table(substring(N, 9, 12))
#2021
FH <- NPF_2021$...11[substring(NPF_2021$...11, 1, 2) == "FH"]
NB <- NPF_2021$...11[substring(NPF_2021$...11, 1, 2) == "NB"]
N <- NPF_2021$...11[substring(NPF_2021$...11, 1, 2) != "FH"]
table(substring(N, 9, 12))
table(substring(FH, 10, 13))
table(substring(NB, 10, 13))
table(NPF_2$Datum.Artikel.op.locatie < 20210420)
table(NPF_2$Datum.Artikel.op.locatie < 20210420)
#more than 1 week
table(NPF_2$Datum.Artikel.op.locatie < 20210412)
#season
table(NPF_2$Seizoen)
table(substring(N, 9, 12))
table(substring(FH, 10, 13))
table(substring(NB, 10, 13))
#season
table(NPF$Seizoen)
length(NPF$Seizoen)
NPF
length(NPF$Locatie)
length(unique(NPF$Locatie))
#number of items on each location
table(NPF_2$Aantal.vrije.voorraad)
#number of duplicates
sum(duplicated(NPF_2$Artikel.barcode))
#number of items on location
table(NPF_2$Aantal.vrije.voorraad)
sum(table(NPF_2$Aantal.vrije.voorraad))
table(NPF$Locatie)
NPF$Locatie
NPF$Locatie > 162
sum(NPF$Locatie > 162)
sum(NPF$Locatie > 162A)
sum(NPF$Locatie > 163)
sum(NPF$Locatie > 164)
NPF_2$Locatie
NPF_2$Locatie > 163
sum(NPF_2$Locatie > 163)
sum(NPF_2$Locatie > 164)
sum(NPF_2$Locatie > 164)
sum(NPF$Locatie > 164)
table(NPF_2$Omschr..1)
#season
table(NPF_2$Seizoen)
#hanging locations
sum(NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164)
#lying locations
sum(NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie < 164)
#return locations: Items longer than 4 weeks
NPF[NPF$Datum.Artikel.op.locatie < 20210210,]
#hanging locations
sum(NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164)
#lying locations
sum(NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie < 164)
#hanging locations
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
#lying locations
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie < 164)
#season
table(NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Seizoen)
NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164)
NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164
NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164]
NPF[[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164]
NPF[NPF$Datum.Artikel.op.locatie < 20210210 & NPF$Locatie > 164,  ]
#hanging
table(NPF[NPF$Datum.Artikel.op.locatie < 20210210 & NPF$Locatie > 164,])
#hanging
table(NPF[NPF$Datum.Artikel.op.locatie < 20210210 & NPF$Locatie > 164,]$Seizoen)
#lying
table(NPF[NPF$Datum.Artikel.op.locatie < 20210210 & NPF$Locatie < 164,]$Seizoen)
#hanging
table(NPF_2[NPF$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Seizoen)
#hanging
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Seizoen)
#lying
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie < 164,]$Seizoen)
#lying
sum(table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie < 164,]$Seizoen))
#hanging
sum(table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Seizoen))
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Seizoen
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Seizoen)
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Seizoen)
length(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Seizoen)
#hanging
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Seizoen)
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]
#hanging locations
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Aantal.vrije.voorraad
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Aantal.vrije.voorraad)
length(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Aantal.vrije.voorraad)
NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164
NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164
sum(NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164)
#return locations: Items longer than 4 weeks
NPF[NPF$Datum.Artikel.op.locatie < 20210210,]
NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie
length(NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Locatie)
sum(NPF[NPF$Datum.Artikel.op.locatie < 20210210,]$Aantal.vrije.voorraad)
#hanging locations
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
#season
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Seizoen)
#hanging locations
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
#season
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Seizoen)
#hanging locations
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
#hanging
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Seizoen)
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Aantal.vrije.voorraad)
length(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Aantal.vrije.voorraad)
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Aantal.vrije.voorraad)
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Aantal.vrije.voorraad
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]
length(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Locatie)
#hanging locations
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
#hanging locations
length(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
#hanging locations
length(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
#hanging locations
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164
#hanging locations
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210 & NPF_2$Locatie > 164,]$Locatie
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210,]$Locatie
NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164)
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210210,]$Locatie > 164)
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329 & NPF_2$Locatie > 164,]$Aantal.vrije.voorraad)
sum(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329,]$Locatie > 164)
#hanging
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329 & NPF_2$Locatie > 164,]$Seizoen)
#lying
sum(table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329 & NPF_2$Locatie < 164,]$Seizoen))
#lying
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329 & NPF_2$Locatie < 164,]$Seizoen)
#lying
table(NPF[NPF$Datum.Artikel.op.locatie < 20210210 & NPF$Locatie < 164,]$Seizoen)
#hanging
table(NPF[NPF$Datum.Artikel.op.locatie < 20210210 & NPF$Locatie > 164,]$Seizoen)
#lying
table(NPF[NPF$Datum.Artikel.op.locatie < 20210210 & NPF$Locatie < 164,]$Seizoen)
#hanging
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329 & NPF_2$Locatie > 164,]$Seizoen)
#lying
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329 & NPF_2$Locatie < 164,]$Seizoen)
#more than 4 weeks
table(NPF_2$Datum.Artikel.op.locatie < 20210329)
NPF
NPF_2020_B2C
NPF_2021_B2C
View(NPF_2020_B2C)
NPF_2020_B2C$...19
NPF_2021_B2C$...19
library(fitdistrplus)
install.packages("C:/Users/20182081/Downloads/fitdistrplus_1.1-3.tar.gz", repos = NULL, type = "source")
library(fitdistrplus)
fitdist(NPF_2020_B2C, "lnorm","mle")
fitdist(NPF_2020_B2C$...19, "lnorm","mle")
NPF_2020_B2C$...19
NPF_2020_B2C$...19
unlist(NPF_2020_B2C$...19)
unlist(NPF_2020_B2C$...19)[-2]
unlist(NPF_2020_B2C$...19)[-1]
unlist(NPF_2020_B2C$...19)[-3]
as.numeric(NPF_2020_B2C$...19)
Return_period <- as.numeric(NPF_2020_B2C$...19)
Return_period[!is.na(Return_period)]
Return_period
Return_period[!is.na(Return_period)]
PERIOD <- Return_period[!is.na(Return_period)]
fitdist(PERIOD, "lnorm", "mle")
Lnorm <- fitdist(PERIOD, "lnorm", "mle")
plot(Lnorm)
unlist(NPF_2020_B2C$...19
plot(Lnorm)
summary(Lnorm)
summary(Lnorm)
Lnorm <- fitdist(PERIOD, "lnorm", method = "mle")
plot(Lnorm)
Lnorm <- fitdist(PERIOD, "gamma", method = "mle")
plot(Lnorm)
Lnorm <- fitdist(PERIOD, "pois", method = "mle")
plot(Lnorm)
Lnorm <- fitdist(PERIOD, "norm", method = "mle")
plot(Lnorm)
plot(PERIOD)
PERIOD <- Return_period[!is.na(Return_period)]
PERIOD
plot(PERIOD)
hist(PERIOD)
hist(PERIOD, breaks = 100)
hist(PERIOD, breaks = 1000)
hist(PERIOD, breaks = 1000, xlim = c(0, 50))
hist(PERIOD, breaks = 100, xlim = c(0, 50))
hist(PERIOD, breaks = 10000 xlim = c(0, 50))
hist(PERIOD, breaks = 1000, xlim = c(0,50))
plot(Lnorm)
PERIOD
max(PERIOD)
sort(PERIOD, decreasing = TRUE)
hist(Test, xlim = c(0,60), breaks = 500, main = "Distribution of return period")
table(Test_V2)
hist(Test_V2)
hist(Test_V2, xlim = c(0,60), breaks = 500, main = "Distribution of return period")
fitdist(Test_V2, "exp", method = "mge")
fitdist(Test_V2, "exp", method = "mle")
plot(fitdist(Test_V2, "exp", method = "mle"))
summary(Test_V2)
fitdist(PERIOD, "weibull")
plot(fitdist(PERIOD, "weibull"))
hist(PERIOD)
hist(PERIOD, xlim=(0. 60))
hist(PERIOD, xlim=(0, 60))
hist(PERIOD, xlim=(0, 60))
hist(PERIOD, xlim=c(0,60))
hist(PERIOD, xlim=c(0,60), breaks = 500)
line(dweibull(seq(0, 60, 1), shape = 1.608633, scale = 14.474804))
lines(dweibull(seq(0, 60, 1), shape = 1.608633, scale = 14.474804))
hist(PERIOD, xlim=c(0,60), breaks = 500, freq = FALSE)
lines(dweibull(seq(0, 60, 1), shape = 1.608633, scale = 14.474804))
lines(dweibull(seq(0, 60, 1), shape = 1.608633, scale = 17))
lines(dweibull(seq(0, 60, 1), shape = 1.608633, scale = 10))
lines(dweibull(seq(0, 60, 1), shape = 1.608633, scale = 8))
lines(dweibull(seq(0, 60, 1), shape = 1.608633, scale = 9))
hist(PERIOD, xlim=c(0,60), breaks = 500, freq = FALSE)
lines(dweibull(seq(0, 60, 1), shape = 1.608633, scale = 9))
lines(dweibull(seq(0, 60, 1), shape = 2, scale = 9))
lines(dweibull(seq(0, 60, 1), shape = 2, scale = 8))
lines(dweibull(seq(0, 60, 1), shape = 2, scale = 10))
hist(PERIOD, xlim=c(0,60), breaks = 500, freq = FALSE)
lines(dweibull(seq(0, 60, 1), shape = 2, scale = 10))
rweibull(1, shape = 2, scale = 10)
rweibull(1, shape = 2, scale = 10)
rweibull(1, shape = 2, scale = 10)
rweibull(1, shape = 2, scale = 10)
rweibull(1, shape = 2, scale = 10)
rweibull(1, shape = 2, scale = 10)
rweibull(1, shape = 2, scale = 10)
rweibull(1, shape = 2, scale = 10)
rweibull(1, shape = 2, scale = 10)
rweibull(1000000, shape = 2, scale = 10)
mean(rweibull(1000000, shape = 2, scale = 10))
mean(rweibull(1000000, shape = 2, scale = 10))
mean(rweibull(1000000, shape = 2, scale = 10))
mean(rweibull(1000000, shape = 2, scale = 10))
mean(PERIOD)
mean(rweibull(1000000, shape = 1.608633, scale = 14.474804))
mean(PERIOD)
plot(fitdist(PERIOD, "binom"))
plot(fitdist(PERIOD, "gamma"))
hist(PERIOD, breaks = 1000, xlim = c(0,50))
hist(PERIOD, xlim=c(0,60), breaks = 500, freq = FALSE)
plot(fitdist(PERIOD, "weibull"))
#all items:
table(NPF$Seizoen)
table(NPF_2$Seizoen)
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329 & NPF_2$Locatie < 164, ]$Seizoen)
#lying
table(NPF_2[NPF_2$Datum.Artikel.op.locatie < 20210329 & NPF_2$Locatie < 164,]$Seizoen)
table(NPF_2[NPF_2$Locatie < 164,]$Seizoen)
table(NPF_2[NPF_2$Locatie < 164,]$Seizoen)
table(NPF_2[NPF_2$Locatie < 164, ]$Seizoen)
table(NPF_2[NPF_2$Locatie < 164,]$Seizoen)
#all items:
table(NPF$Seizoen)
#lying
table(NPF_2[NPF_2$Locatie < 164,]$Seizoen)
#lying
table(NPF_2[NPF_2$Locatie < 164,]$Seizoen)
table(NPF[NPF$Locatie < 164, ]$Seizoen)
table(NPF_2[NPF_2$Locatie > 164,]$Seizoen)
table(NPF[NPF$Locatie > 164, ]$Seizoen)
table(NPF_2[NPF_2$Locatie > 164,]$Seizoen)
table(NPF[NPF$Locatie > 164, ]$Seizoen)
hoi
data.frame(Data)
Data <- read.csv("C:/Users/20182081/OneDrive - TU Eindhoven/2022-2023/IST_Lisboa/Courses/SMDM/Project/MI.data", header=FALSE)
View(Data)
View(Data)
1+1
2+1
1+1
2+1
2+1
1+1
2+1
c(1,2,3)*10
x <- 5
x*x
exp(1)
x+3
lx<-c(15:1, 3:11, 7*2, 8) # creates a vector
length(lx)
lx
m<-matrix(lx,13,2,byrow=TRUE)
m
log(lx)
log(lx,10)
sqrt(lx)
m%*%lx[1:2]
lx[1:2]
m%*%t(m)
library(rio)
install.packages("rio")
urlmy<-"https://web.tecnico.ulisboa.pt/~ist13493/AM2023/Lab1/pardais.xlsx"
pardais<-import(urlmy)
pardais <- import(urlmy)
import(urlmy)
pardais<-import("pardais.xlsx")
import("pardais.xlsx")
=======
(q*Cup + (1-q)*Cdown)/R
}
#minus the strickeprice to get the margin. If it is below 0 it becomes 0
payoff1 <- K1 - endinvestment2
payoff1[payoff1<0] <- 0
payoff2 <- K2 - endinvestment2
payoff2[payoff2<0] <- 0
payoff3 <- K3 - endinvestment2
payoff3[payoff3<0] <- 0
#makes the first line of the matrix the end payoff
payoffmatrix1 <- matrix(nrow = length(payoff1), ncol = length(payoff1))
payoffmatrix1[1,] <- payoff1
#makes the first line of the matrix the end payoff
payoffmatrix2 <- matrix(nrow = length(payoff2), ncol = length(payoff2))
payoffmatrix2[1,] <- payoff2
#makes the first line of the matrix the end payoff
payoffmatrix3 <- matrix(nrow = length(payoff3), ncol = length(payoff3))
payoffmatrix3[1,] <- payoff3
#using the formula of option pricing via backwards recursion
#every time a step back, gets a matrix with at the end the price
for (j in 1:length(payoff1)){
for(i in 1:length(payoff1)-1){
payoffmatrix1[j+1,i] <- price(payoffmatrix1[j,i+1], payoffmatrix1[j,i])
}
}
put1 <- payoffmatrix1[NrPeriods+1,1]
for (j in 1:length(payoff2)){
for(i in 1:length(payoff2)-1){
payoffmatrix2[j+1,i] <- price(payoffmatrix2[j,i+1], payoffmatrix2[j,i])
}
}
put2 <- payoffmatrix2[NrPeriods+1,1]
for (j in 1:length(payoff3)){
for(i in 1:length(payoff3)-1){
payoffmatrix3[j+1,i] <- price(payoffmatrix3[j,i+1], payoffmatrix3[j,i])
}
}
put3 <- payoffmatrix3[NrPeriods+1,1]
#total price
put1 - 2*put2 + put3
#they can also be computed by another way
#one period binomial
mu <- v + 1/2 * sigma^2
u1 <- (mu^2 + sqrt(mu^4+4*mu^3+4*mu^2+4*sigma^4)+ 2*mu +2)/(2*(mu-sigma^2+1))
d1 <- u1^-1
p1 <- (mu*u1 + u1 -1)/(u1^2 -1)
#get the endinvestment final numbers
endinvestment_new <- c(S0 *d1,S0 *u1)
#minus the strickeprice to get the margin. If it is below 0 it becomes 0
payoff1_new <- K1 - endinvestment_new
payoff1_new[payoff1_new<0] <- 0
payoff2_new <- K2 - endinvestment_new
payoff2_new[payoff2_new<0] <- 0
payoff3_new <- K3 - endinvestment_new
payoff3_new[payoff3_new<0] <- 0
put1_new <- price(payoff1_new[2], payoff1_new[1])
put2_new <- price(payoff2_new[2], payoff2_new[1])
put3_new <- price(payoff3_new[2], payoff3_new[1])
#totalprice
put1_new - 2*put2_new + put3_new
#parameters
v <- 1.02604
sigma <- 0.650496
r <- (v + 0.5*sigma^2)
S0 <- 1766.8
K1 <- 1700
K2 <- 2000
K3 <- 2300
St <- seq(0, 2600, 1)
butterfly <- function(){
-pmax(K1-St,0) + 2* pmax(K2-St,0)- pmax(K3-St,0)
}
#using the Black-Scholes model, compute the price of the 1 year European call option
t <- 0
Time <- 1
d1_1
#option 1
d1_1 <- (1/(sigma*sqrt(Time-t)))*(log(S0/K1)+(r+(sigma^2)/2)*(Time-t))
d2_1 <- d1_1 - sigma*sqrt(Time-t)
price_put1 <- pnorm(-d2_1)*K1*exp(-r*(Time-t))-pnorm(-d1_1)*S0
#option 2
d1_2 <- (1/(sigma*sqrt(Time-t)))*(log(S0/K2)+(r+(sigma^2)/2)*(Time-t))
d2_2 <- d1_2 - sigma*sqrt(Time-t)
price_put2 <- pnorm(-d2_2)*K2*exp(-r*(Time-t))-pnorm(-d1_2)*S0
#option 3
d1_3 <- (1/(sigma*sqrt(Time-t)))*(log(S0/K3)+(r+(sigma^2)/2)*(Time-t))
d2_3 <- d1_3 - sigma*sqrt(Time-t)
price_put3 <- pnorm(-d2_3)*K3*exp(-r*(Time-t))-pnorm(-d1_3)*S0
#part a
#delta of portfolio
delta1 <- -pnorm(-d1_1)
delta2 <- -pnorm(-d1_2)
delta3 <- -pnorm(-d1_3)
delta_portfolio <- -delta1 + 2* delta2 - delta3
#gamma of portfolio
gamma1 <- dnorm(d1_1)/(S0 * sigma * sqrt(T-t))
gamma2 <- dnorm(d1_3)/(S0 * sigma * sqrt(T-t))
gamma3 <- dnorm(d1_2)/(S0 * sigma * sqrt(T-t))
gamma_portfolio <- -gamma1 + 2*gamma2 - gamma3
#vega of portfolio
vega1 <- S0 * dnorm (d1_1) * sqrt(T-t)
vega2 <- S0 * dnorm (d1_2) * sqrt(T-t)
vega3 <- S0 * dnorm (d1_3) * sqrt(T-t)
vega_portfolio <- -vega1 + 2*vega2 - vega3
1/(sqrt(2* pi)*exp(-d1_1)^2/2)
dnorm(d1_1)
#theta of portfolio
theta1 <- -(S0 * dnorm(d1_1)*sigma)/(2 * sqrt(T-t)) + r*K1 *exp(-r * (T-t))*pnorm(-d2_1)
theta2 <- -(S0 * dnorm(d1_2)*sigma)/(2 * sqrt(T-t)) + r*K2 *exp(-r * (T-t))*pnorm(-d2_2)
theta3 <- -(S0 * dnorm(d1_3)*sigma)/(2 * sqrt(T-t)) + r*K3 *exp(-r * (T-t))*pnorm(-d2_3)
theta_portfolio <- -theta1 +2*theta2 - theta3
#rho of portfolio
rho1 <- -K1 * exp(-r * (T-t)) * pnorm(-d2_1)
rho2 <- -K2 * exp(-r * (T-t)) * pnorm(-d2_2)
rho3 <- -K3 * exp(-r * (T-t)) * pnorm(-d2_3)
rho_portfolio <- -rho1 + 2*rho2 - rho3
delta_portfolio
gamma_portfolio
vega_portfolio
theta_portfolio
rho_portfolio
#part b
t2 <- seq(0,1, 1/12)
St <- c(S0, 2131.77, 2572.13,3103.46, 3744.54,4518.05, 5451.34,6577.43, 7936.13,6577.43, 5451.34,4518.05, 3744.54)
data.frame(t2,St)
#parameters
v <- 1.02604
sigma <- 0.650496
r <- (v + 0.5*sigma^2)
S0 <- 1766.8
K1 <- 1700
K2 <- 2000
K3 <- 2300
St <- seq(0, 2600, 1)
butterfly <- function(){
-pmax(K1-St,0) + 2* pmax(K2-St,0)- pmax(K3-St,0)
}
#using the Black-Scholes model, compute the price of the 1 year European call option
t <- 0
Time <- 1
d1_1
#option 1
d1_1 <- (1/(sigma*sqrt(Time-t)))*(log(S0/K1)+(r+(sigma^2)/2)*(Time-t))
d2_1 <- d1_1 - sigma*sqrt(Time-t)
price_put1 <- pnorm(-d2_1)*K1*exp(-r*(Time-t))-pnorm(-d1_1)*S0
#option 2
d1_2 <- (1/(sigma*sqrt(Time-t)))*(log(S0/K2)+(r+(sigma^2)/2)*(Time-t))
d2_2 <- d1_2 - sigma*sqrt(Time-t)
price_put2 <- pnorm(-d2_2)*K2*exp(-r*(Time-t))-pnorm(-d1_2)*S0
#option 3
d1_3 <- (1/(sigma*sqrt(Time-t)))*(log(S0/K3)+(r+(sigma^2)/2)*(Time-t))
d2_3 <- d1_3 - sigma*sqrt(Time-t)
price_put3 <- pnorm(-d2_3)*K3*exp(-r*(Time-t))-pnorm(-d1_3)*S0
#part a
#delta of portfolio
delta1 <- -pnorm(-d1_1)
delta2 <- -pnorm(-d1_2)
delta3 <- -pnorm(-d1_3)
delta_portfolio <- -delta1 + 2* delta2 - delta3
#gamma of portfolio
gamma1 <- dnorm(d1_1)/(S0 * sigma * sqrt(T-t))
gamma2 <- dnorm(d1_3)/(S0 * sigma * sqrt(T-t))
gamma3 <- dnorm(d1_2)/(S0 * sigma * sqrt(T-t))
gamma_portfolio <- -gamma1 + 2*gamma2 - gamma3
#vega of portfolio
vega1 <- S0 * dnorm (d1_1) * sqrt(T-t)
vega2 <- S0 * dnorm (d1_2) * sqrt(T-t)
vega3 <- S0 * dnorm (d1_3) * sqrt(T-t)
vega_portfolio <- -vega1 + 2*vega2 - vega3
1/(sqrt(2* pi)*exp(-d1_1)^2/2)
dnorm(d1_1)
#theta of portfolio
theta1 <- -(S0 * dnorm(d1_1)*sigma)/(2 * sqrt(T-t)) + r*K1 *exp(-r * (T-t))*pnorm(-d2_1)
theta2 <- -(S0 * dnorm(d1_2)*sigma)/(2 * sqrt(T-t)) + r*K2 *exp(-r * (T-t))*pnorm(-d2_2)
theta3 <- -(S0 * dnorm(d1_3)*sigma)/(2 * sqrt(T-t)) + r*K3 *exp(-r * (T-t))*pnorm(-d2_3)
theta_portfolio <- -theta1 +2*theta2 - theta3
#rho of portfolio
rho1 <- -K1 * exp(-r * (T-t)) * pnorm(-d2_1)
rho2 <- -K2 * exp(-r * (T-t)) * pnorm(-d2_2)
rho3 <- -K3 * exp(-r * (T-t)) * pnorm(-d2_3)
rho_portfolio <- -rho1 + 2*rho2 - rho3
delta_portfolio
gamma_portfolio
vega_portfolio
theta_portfolio
rho_portfolio
#part b
t2 <- seq(0,1, 1/12)
St <- c(S0, 2131.77, 2572.13,3103.46, 3744.54,4518.05, 5451.34,6577.43, 7936.13,6577.43, 5451.34,4518.05, 3744.54)
data.frame(t2,St)
>>>>>>> Stashed changes
library(readxl)
pardais <- read_excel(NULL)
View(pardais)
library(readxl)
pardais <- read_excel("C:/Users/20182081/OneDrive - TU Eindhoven/2022-2023/IST_Lisboa/Courses/SMDM/Project/pardais.xlsx")
pardais
summary(pardais)
View(pardais)
View(pardais)
R.version
<<<<<<< Updated upstream
setwd("~/GitHub/SMDM")
#Import libraries
=======
library(dplyr)
library(tidyr)
library(purrr)
library(ggplot2)
# # Real/numerical 2, 35, 36, 37, 38, 84, 86, 87, 88, 89. 90, 91  normalizen, anders te veel effect
#
#Steps in order to fix the dataset
#Load Dataset
# data<-read.csv("datasets/MI.data")
data <- read.table('datasets/MI.data', sep = ',')
setwd("~/Github/SMDM")
library(dplyr)
library(tidyr)
library(purrr)
>>>>>>> Stashed changes
library(ggplot2)
(cowplot)
library(cowplot)
data <- read.table('datasets/MI.data', sep = ',')
data[]<-lapply(data, function(x) as.numeric(as.character(x))) #Force all datatypes to be numeric
y <- data[c(122)]#Output
#Remove variables that are useless
data <- data[-c(1, 95, 102, 105, 112:121, 123, 124)]
#Remove variables that have more than 25% missing values
data<-data[, which(colMeans(!is.na(data)) > 0.25)]
#Fix NaN values: Real variables: Mean, Binary variables: Mode
getmode <- function(v) { #Function for the mode
uniqv <- unique(v)
uniqv[which.max(tabulate(match(v, uniqv)))]
}
data_na <- data
for(i in 1:ncol(data)) {
if (is.na(getmode (data_na[ , i]))){ #If mode is NA, most likely that it is real value, mean is okay
data_na[ , i][is.na(data_na[ , i])] <- mean(data_na[ , i], na.rm = TRUE)
}
else{ #Take for the ordinal and binary
data_na[ , i][is.na(data_na[ , i])] <- getmode(data_na[ , i])
}
}
#Normalization/standardization of real values
min_max_norm <- function(x) {
(x - min(x)) / (max(x) - min(x))
}
data_norm <- as.data.frame(lapply(data_na, min_max_norm))
#Split the data set in two seperate dataframes based on Binary vs real/ordinal
binary_data <- Filter(function(x) all(x %in% c(0, 1)), data_norm)
real_data <- data.frame(data_norm[, -which(names(data_norm) %in% names(binary_data))])
#Remove variables with correlation matrix (real variables and ordinal data)
#Remove variables with Chi-Squared test (Binary variables)
#Code for chi-squared correlations between dependent variable and the independent variables
#H0: The two variables are independent.
#H1: The two variables relate to each other.
x <- 1:length(binary_data)
result <- vector('list', length(x))
for(i in x){
test <- chisq.test(binary_data[,colnames(binary_data[i])], y$V122)
result[[i]] <- data.frame("X" = colnames(binary_data[i]),
"Y" = colnames(y),
"Chi.Square" = round(test$statistic,3),
"df"= test$parameter,
"p.value" = round(test$p.value, 3))
}
#print(result) # to see the p values
#p values < 0.05: reject Null hypothesis : the selected variables are dependent, so can be used to predict the dependent variable
#Feature selection: Selection variables that can be removed
x <- 1:length(binary_data)
Remove_vars <- c(rep(0,length(binary_data)))
for(i in x){
if(result[[i]][[5]]> 0.05){
Remove_vars[i] <- result[[i]][[1]]
}
}
#Remove binary variables that have p-value > 0.05
data_final_binary <- binary_data[ , !(names(binary_data) %in% Remove_vars)]
#Removal of redundant variables real and ordinal data
#Get correlation matrix. Don't forget to ignore categorical variables in this process
cormat<-round(cor(real_data),2)
################### AUXILIARY FUNCTIONS ##########################
# Get upper triangle of the correlation matrix
get_upper_tri <- function(cormat){
cormat[lower.tri(cormat)]<- NA
return(cormat)
}
##################################################################
upper_tri <- get_upper_tri(cormat)
#Remove one variable of pair with high correlation.
related_index = c()
for (line in 1:dim(upper_tri)[1]){
for (col in 1:line){
i = col+dim(upper_tri)[1]*(line-1)
if (abs(upper_tri[i])>0.8 & abs(upper_tri[i])<1){
related_index<-c(related_index, line)
}
}
}
data_final_real<-real_data[-related_index]
#Merge, y variable is V122
final_data <- cbind(data_final_binary,data_final_real)
<<<<<<< Updated upstream
#Dependent variable
final_data$V122
colnames(final_data)[1]
EDA_dataset <- data_na[, colnames(final_data)]
summary(EDA_dataset)
Dependent_var <- table(data_na$V122)
barplot(Dependent_var, main="Myocarditis",
xlab="No")
#Grouped bar plots for categorical data
#dat <- data.frame(table(binary_data$V3,binary_data$V122))
#names(dat) <- c("independent", "dependent", "count")
#ggplot(data=dat) + geom_bar(stat="indentity")
#ggplot(data=dat, aes(x=binary_data$V3, y=dat$Freq, fill=binary_data$V122)) + geom_bar(stat="indentity")
#ggplot(data=dat, aes(x=Fruit, y=Count, fill=Bug)) + geom_bar(stat="identity")
# Grouped Bar Plot
#data_na$V3
#counts <- table(data_na$V122, data_na$V3)
#barplot(counts, main="Car Distribution by Gears and VS",
#        xlab="Number of Gears", col=c("darkblue","red"),
#        legend = rownames(counts), beside=TRUE)
#Fruit <- c(rep("Apple",3),rep("Orange",5))
#Bug <- c("worm","spider","spider","worm","worm","worm","worm","spider")
#df <- data.frame(Fruit,Bug)
#dat <- data.frame(table(df$Fruit,df$Bug))
#ames(dat) <- c("Fruit","Bug","Count")
#ggplot(data=dat, aes(x=Fruit, y=Count, fill=Bug)) + geom_bar(stat="identity")
#colnames(data_final_binary)
#test
#x <- length(binary_data)
#for(i in x){
#  df <- data.frame(binary_data[binary_data[, x], binary_data$V122)
#  dat <- data.frame(table(df$binary_data.))
#}
#binary_data[]
#Stacked bar plots of binary data
pdf(file="Stacked_bar_plots.pdf")
par(mfrow= c(3,3))
#V3
df <- data.frame(binary_data$V3, binary_data$V122)
data.frame(table(binary_data$v3, binary_data$v122))
dat <- data.frame(table(df$binary_data.V3,df$binary_data.V122))
names(dat) <- c("V3", "V122", "Count")
p1 <- ggplot(data=dat, aes(x=V3, y=Count, fill=V122)) + geom_bar(stat="identity")
#V20
df <- data.frame(binary_data$V20, binary_data$V122)
data.frame(table(binary_data$v20, binary_data$v122))
dat <- data.frame(table(df$binary_data.V20,df$binary_data.V122))
names(dat) <- c("V20", "V122", "Count")
p2 <- ggplot(data=dat, aes(x=V20, y=Count, fill=V122)) + geom_bar(stat="identity")
#V27
df <- data.frame(binary_data$V27, binary_data$V122)
data.frame(table(binary_data$v27, binary_data$v122))
dat <- data.frame(table(df$binary_data.V27,df$binary_data.V122))
names(dat) <- c("V27", "V122", "Count")
p3 <- ggplot(data=dat, aes(x=V27, y=Count, fill=V122)) + geom_bar(stat="identity")
#V30
df <- data.frame(binary_data$V30, binary_data$V122)
data.frame(table(binary_data$v30, binary_data$v122))
dat <- data.frame(table(df$binary_data.V30,df$binary_data.V122))
names(dat) <- c("V30", "V122", "Count")
p4 <- ggplot(data=dat, aes(x=V30, y=Count, fill=V122)) + geom_bar(stat="identity")
#V31
df <- data.frame(binary_data$V31, binary_data$V122)
data.frame(table(binary_data$v31, binary_data$v122))
dat <- data.frame(table(df$binary_data.V31,df$binary_data.V122))
names(dat) <- c("V31", "V122", "Count")
p5 <- ggplot(data=dat, aes(x=V31, y=Count, fill=V122)) + geom_bar(stat="identity")
#V43
df <- data.frame(binary_data$V43, binary_data$V122)
data.frame(table(binary_data$v43, binary_data$v122))
dat <- data.frame(table(df$binary_data.V43,df$binary_data.V122))
names(dat) <- c("V43", "V122", "Count")
p6 <- ggplot(data=dat, aes(x=V43, y=Count, fill=V122)) + geom_bar(stat="identity")
#V54
df <- data.frame(binary_data$V54, binary_data$V122)
data.frame(table(binary_data$v54, binary_data$v122))
dat <- data.frame(table(df$binary_data.V54,df$binary_data.V122))
names(dat) <- c("V54", "V122", "Count")
p7 <- ggplot(data=dat, aes(x=V54, y=Count, fill=V122)) + geom_bar(stat="identity")
#V99
df <- data.frame(binary_data$V99, binary_data$V122)
data.frame(table(binary_data$v99, binary_data$v122))
dat <- data.frame(table(df$binary_data.V99,df$binary_data.V122))
names(dat) <- c("V99", "V122", "Count")
p8 <- ggplot(data=dat, aes(x=V99, y=Count, fill=V122)) + geom_bar(stat="identity")
#V109
df <- data.frame(binary_data$V109, binary_data$V122)
data.frame(table(binary_data$v109, binary_data$v122))
dat <- data.frame(table(df$binary_data.V109,df$binary_data.V122))
names(dat) <- c("V109", "V122", "Count")
p9 <- ggplot(data=dat, aes(x=V109, y=Count, fill=V122)) + geom_bar(stat="identity")
plot_grid(p1, p2, p3, p4, p5, p6, p7, p8, p9)
=======
#
saveRDS(final_data, file = "datasets/preprocessed.RDS")
pdf(file= "Histograms_y.pdf" )
# create a 2X2 grid
par( mfrow= c(3,2) )
#
for (i in colnames(real_data_split_0)){
if( i != 'V122'){
real_data_split_0 %>%  pull(i) %>% hist(main = paste(i, ", V122 is False", sep=""), col = 'coral1')
real_data_split_1 %>%  pull(i) %>% hist(main = paste(i, ", V122 is True", sep=""), col = 'cyan3')
}
}
>>>>>>> Stashed changes
